<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/05/11/hello-world/"/>
      <url>/2022/05/11/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><h3 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h3><ul><li>这里引用变量 <script type="math/tex">a_i</script></li><li><script type="math/tex; mode=display">\sigma = x_1 + y_1</script></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>自制电子时钟</title>
      <link href="/2020/08/19/clock-conclusion/"/>
      <url>/2020/08/19/clock-conclusion/</url>
      
        <content type="html"><![CDATA[<h1 id="自制电子时钟—总结"><a href="#自制电子时钟—总结" class="headerlink" title="自制电子时钟—总结"></a>自制电子时钟—总结</h1><h2 id="使用到的模块及其功能："><a href="#使用到的模块及其功能：" class="headerlink" title="使用到的模块及其功能："></a>使用到的模块及其功能：</h2><ul><li>DS1302：低功耗实时时钟芯片，它可以对年、月、日、周、时、分、秒进行计时，且具有闰年补偿等多种功能。</li><li>LCD1602：用来显示字母、数字、符号等的点阵型液晶模块，能够同时显示16x02即32个字符。</li><li>按键k1,k2,k3,k4：<br>k1：切换模式，比如工作模式、计时模式、设置模式。<br>k2：设置模式: plus；计时模式: 打开计时，暂停计时<br>k3：设置模式: shift；计时模式：归零<br>k4：闹钟响时，关闭闹钟</li><li>蜂鸣器：闹钟铃声，天空之城</li></ul><h2 id="主要原理："><a href="#主要原理：" class="headerlink" title="主要原理："></a>主要原理：</h2><p>&emsp; &emsp; 工作模式下，51单片机从DS1302中获取数据，再把数据传递到LCD来显示时间和日期；设置模式下，通过k2和k3来改变数据；计时模式下，通过k2来打开或关闭定时器1，来实现开始/暂停计时，通过k3来计时初始化；闹钟响时，打开定时器1，通过天空之城乐谱来控制蜂鸣器的音调。  </p><h2 id="DS1302"><a href="#DS1302" class="headerlink" title="DS1302"></a>DS1302</h2><p>编码是BCD8421编码，用4位二进制数来表示1位十进制数中的0~9这10个数字  </p><div class="table-container"><table><thead><tr><th style="text-align:center">十进制数</th><th style="text-align:center">8421码</th></tr></thead><tbody><tr><td style="text-align:center">0</td><td style="text-align:center">0000</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">0001</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">0010</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">0011</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">0100</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">0101</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">0110</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">0111</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">1000</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">1001</td></tr></tbody></table></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*BCD8421编码，十进制数据转换成BCD码 */</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">encode_BCD</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> dat)</span>   </span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> dat1,dat2;</span><br><span class="line">dat1 = dat/<span class="number">10</span>;</span><br><span class="line">dat2 = dat%<span class="number">10</span>;</span><br><span class="line">dat = dat2 + dat1*<span class="number">16</span>;</span><br><span class="line"><span class="keyword">return</span> dat; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*BCD8421解码，BCD码转换成十进制数据   */</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">decode_BCD</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> dat)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> dat1,dat2;</span><br><span class="line">dat1 = dat/<span class="number">16</span>;</span><br><span class="line">dat2 = dat%<span class="number">16</span>;</span><br><span class="line">dat = dat2 + dat1*<span class="number">10</span>;</span><br><span class="line"><span class="keyword">return</span> dat;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>读写数据到DS1302<br>  DS1302的数据读写是通过I/O串行进行的。当进行一次读写操作时最少得发送两个字节，第一个字节是控制字节，就是一个命令，告诉DS1302是读还是写操作，是对RAM还是对CLOK寄存器操作，以及操作的地址。第二个字节就是要读或写的数据了。 </p><ol><li>控制字节<br><img src="http://www.elecfans.com/uploads/allimg/171020/2362487-1G02009234UB.jpg" alt="控制指令">  <ul><li>位0就是读写位，当位0为1时，就是告诉DS1302，下面是进行读出操作，而当位0为0时就是写入操作。  </li><li>位0－位5是要进行操作的DS1302寄存器地址。<br>位6就是告诉DS1302，是要对RAM进行操作还是对时间寄存器进行操作，0就是对时间寄存器操作，一般我们都是对时间寄存器进行操作。  </li><li>位7就是固定的1。  </li><li>现在就知道为什么控制字80H是写秒寄存器，而81H是读秒寄存器了吧。80H换成二进制就是10000000。而81H的二进制就是10000001，一个是写操作，另一个是读操作嘛！  </li></ul></li><li>读写操作<br><img src="http://www.elecfans.com/uploads/allimg/171020/2362487-1G02009241L44.jpg" alt="读写">  <ul><li>写：<br>在进行操作之前先得将CE（也可说是RST）置高电平，然后单片机将控制字的位0放到I/O上，当I/O的数据稳定后，将SCLK置高电平，DS1302检测到SCLK的上升沿后就将I/O上的数据读取，然后单片机将SCLK置为低电平，再将控制字的位1放到I/O上，如此反复，将一个字节控制字的8个位传给DS1302。<br>接下来就是传一个字节的数据给DS1302，在SCLK低电平时单片机将数据放到IO上，当SCLK上升沿时，DS1302读取。当传完数据后，单片机将CE置为低电平，操作结束。</li><li>读：<br>在进行操作之前先得将CE（也可说是RST）置高电平，然后单片机将控制字的位0放到I/O上，当I/O的数据稳定后，将SCLK置高电平，DS1302检测到SCLK的上升沿后就将I/O上的数据读取，然后单片机将SCLK置为低电平，再将控制字的位1放到I/O上，如此反复，将一个字节控制字的8个位传给DS1302。<br>接下来就是从DS1302读数据，在SCLK高电平时DS1302放数据到IO上，将SCLK置为低电平后，产生下降沿电压，单片机就可从IO上读取数据。当传完数据后，单片机将CE置为低电平，操作结束。<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*写入数据到DS1302*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">write_DS1302_dat</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> addr,<span class="type">unsigned</span> <span class="type">char</span> dat)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line"><span class="comment">//初始化</span></span><br><span class="line">TRST = <span class="number">0</span>;</span><br><span class="line">_nop_(); </span><br><span class="line">TSCLK = <span class="number">0</span>;</span><br><span class="line">_nop_();</span><br><span class="line"></span><br><span class="line">TRST = <span class="number">1</span>; <span class="comment">//拉高CE，开始读写数据</span></span><br><span class="line">_nop_();</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)<span class="comment">//写入地址</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">TIO = addr &amp; <span class="number">0x01</span>;<span class="comment">//发送地址的最低位 </span></span><br><span class="line">addr &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">TSCLK = <span class="number">1</span>;<span class="comment">//产生上升沿电压，写入命令</span></span><br><span class="line">_nop_();</span><br><span class="line">TSCLK = <span class="number">0</span>;</span><br><span class="line">_nop_();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)<span class="comment">//写入数据</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">TIO = dat &amp; <span class="number">0x01</span>;<span class="comment">//发送数据的最低位</span></span><br><span class="line">dat &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">TSCLK = <span class="number">1</span>;<span class="comment">//产生上升沿电压，写入数据</span></span><br><span class="line">_nop_();</span><br><span class="line">TSCLK = <span class="number">0</span>;</span><br><span class="line">_nop_();</span><br><span class="line">&#125;</span><br><span class="line">TRST = <span class="number">0</span>; <span class="comment">//数据传输结束</span></span><br><span class="line">_nop_();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*从DS1302读取数据*/</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">read_DS1302_dat</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> addr)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> i,dat=<span class="number">0</span>,dat1=<span class="number">0</span>;</span><br><span class="line"><span class="comment">//初始化</span></span><br><span class="line">TRST = <span class="number">0</span>;</span><br><span class="line">_nop_(); </span><br><span class="line">TSCLK = <span class="number">0</span>;</span><br><span class="line">_nop_();</span><br><span class="line"></span><br><span class="line">TRST = <span class="number">1</span>; <span class="comment">//拉高CE，开始读写数据</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)<span class="comment">//开始传送八位地址命令</span></span><br><span class="line">&#123;    </span><br><span class="line">TIO = addr &amp; <span class="number">0x01</span>;<span class="comment">//发送地址的最低位 </span></span><br><span class="line">addr &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">TSCLK = <span class="number">1</span>;<span class="comment">//产生上升沿电压，写入命令</span></span><br><span class="line">_nop_();</span><br><span class="line">TSCLK = <span class="number">0</span>;<span class="comment">//DS1302下降沿时，放置数据</span></span><br><span class="line">_nop_();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)<span class="comment">//读取8位数据</span></span><br><span class="line">&#123;</span><br><span class="line">dat1 = TIO;<span class="comment">//从最低位开始接收</span></span><br><span class="line">dat = (dat&gt;&gt;<span class="number">1</span>) | (dat1&lt;&lt;<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">TSCLK = <span class="number">1</span>;</span><br><span class="line">_nop_();</span><br><span class="line">TSCLK = <span class="number">0</span>;<span class="comment">//产生下降沿电压，读取数据</span></span><br><span class="line">_nop_();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">TRST = <span class="number">0</span>;</span><br><span class="line">_nop_();<span class="comment">//以下为DS1302复位的稳定时间,必须的。</span></span><br><span class="line">TSCLK = <span class="number">1</span>;</span><br><span class="line">_nop_();</span><br><span class="line">TIO = <span class="number">0</span>;</span><br><span class="line">_nop_();</span><br><span class="line">TIO = <span class="number">1</span>;</span><br><span class="line">_nop_();</span><br><span class="line"><span class="keyword">return</span> dat;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ol><h2 id="LCD1602"><a href="#LCD1602" class="headerlink" title="LCD1602"></a>LCD1602</h2><ul><li>LCD操作模式  </li></ul><div class="table-container"><table><thead><tr><th>输入</th><th>输出</th><th>输出</th></tr></thead><tbody><tr><td>读状态</td><td>RS=0,RW=H,EN为高变低脉冲</td><td>D0~D7个状态值</td></tr><tr><td>读数据</td><td>RS=1,RW=1,EN为高变低脉冲</td><td>无</td></tr><tr><td>写指令</td><td>RS=0,RW=0,D0—D7=数据,EN由高脉冲变为低脉冲</td><td>D0—D7状态值</td></tr><tr><td>写数据</td><td>RS=1, RW=0, D0—D7=数据，EN由高脉冲变为低脉冲</td><td>D0—D7状态值</td></tr></tbody></table></div><ul><li><p>详细说明：<br>(1) RS和RW都为0时表示对LCD写指令操作，包括写入LCD的显示模式和设定LCD地址的指令。.显示模式包括清屏、地址归为、显示状态、进入点设定、功能设定、游标显示模式操作;关于地址的操作包括设定CGRAM地址、设定DDRAM地址。<br>(2) 当RS=0,RW=1时，表示读LCD状态，此时可以读取LCD忙信号，同时可以读取地址计数器的值。忙信号的状态用来确定LCD内部动作是否完成，若在LCD内部出于忙状态时对LCD进行读写操作将会失败。<br>(3) 当RS=1时，若RW=0表示写数据操作，若RW=1表示读数据操作  </p></li><li><p>地址：<br>LCD供两行，第一行可立即显示字符的地址为00H—0FH，第二行可立即显示字符的地址为40H—67H。  </p></li></ul><hr><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断液晶是否忙，如果忙就等待</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">read_busy</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> busy;</span><br><span class="line">P0 = <span class="number">0xff</span>;</span><br><span class="line">RS = <span class="number">0</span>;</span><br><span class="line">RW = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">EN = <span class="number">1</span>;</span><br><span class="line">busy = P0;   <span class="comment">//读状态，RS = 0;RW = 1;EN = 1;</span></span><br><span class="line">EN = <span class="number">0</span>;</span><br><span class="line">&#125;<span class="keyword">while</span>(busy &amp; <span class="number">0x80</span>); <span class="comment">//判断状态码最高位，STA7读写使能，1：禁止，0：允许</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//写1字节指令</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">write_cmd</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> cmd)</span>   <span class="comment">//RS=L,RW=L,E=下降沿脉冲</span></span><br><span class="line">&#123;</span><br><span class="line">read_busy();</span><br><span class="line">RS = <span class="number">0</span>;</span><br><span class="line">RW = <span class="number">0</span>;</span><br><span class="line">P0 = cmd;</span><br><span class="line">EN = <span class="number">1</span>;</span><br><span class="line">EN = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//写1字节数据</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">write_dat</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> dat)</span>   <span class="comment">//RS=H,RW=L,E=下降沿脉冲</span></span><br><span class="line">&#123;</span><br><span class="line">read_busy();</span><br><span class="line">RS = <span class="number">1</span>;</span><br><span class="line">RW = <span class="number">0</span>;</span><br><span class="line">P0 = dat;</span><br><span class="line">EN = <span class="number">1</span>;</span><br><span class="line">EN = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="蜂鸣器"><a href="#蜂鸣器" class="headerlink" title="蜂鸣器"></a>蜂鸣器</h2><p>核心代码：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">delay_us</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> t)</span> <span class="comment">//us延时 12MHz下</span></span><br><span class="line">&#123;</span><br><span class="line">t/=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">for</span>(t;t;t--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">play_tone</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> tone)</span> <span class="comment">//播音调函数，就是方波发生器</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Buzzer=!Buzzer; </span><br><span class="line">delay_us(tone);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>定时器获取延时时间：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> t)</span> <span class="comment">//毫秒延时12MHz下</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(t--)</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">75</span>;i++);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">time_init</span><span class="params">( <span class="type">void</span> )</span></span><br><span class="line">&#123;</span><br><span class="line">TMOD|=<span class="number">0x10</span>; <span class="comment">//使用定时器1</span></span><br><span class="line">TH1=(<span class="number">65536</span><span class="number">-65000</span>)/<span class="number">256</span>; <span class="comment">//装初值</span></span><br><span class="line">TL1=(<span class="number">65536</span><span class="number">-65000</span>)%<span class="number">256</span>;</span><br><span class="line">EA =  <span class="number">1</span>; <span class="comment">//开中断，打开定时器开关</span></span><br><span class="line">ET1 = <span class="number">1</span>;</span><br><span class="line">TR1 = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">timer1_interrupt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *song)</span>  <span class="comment">//定时器1 中断</span></span><br><span class="line">&#123;</span><br><span class="line">TH1=(<span class="number">65536</span><span class="number">-50000</span>)/<span class="number">256</span>; <span class="comment">//装初值</span></span><br><span class="line">TL1=(<span class="number">65536</span><span class="number">-50000</span>)%<span class="number">256</span>;</span><br><span class="line">music_s++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(music_s&gt;=<span class="number">4</span>*t_tone) <span class="comment">//一个音节播放的时间，这里可以通过调t_tone前的系数可以改变时长</span></span><br><span class="line">&#123;</span><br><span class="line">music_s=<span class="number">0</span>; <span class="comment">//讲计时器清零</span></span><br><span class="line"><span class="keyword">if</span>((*tone_p)!=<span class="number">0</span>) <span class="comment">//如果音不是0</span></span><br><span class="line">tone = tones[*tone_p+<span class="number">7</span>*(*(tone_p+<span class="number">1</span>))<span class="number">-1</span>];  <span class="comment">//赋值音调</span></span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">tone = <span class="number">0</span>;     <span class="comment">//关了蜂鸣器</span></span><br><span class="line">t_tone = *(tone_p+<span class="number">2</span>); <span class="comment">//取时间啊</span></span><br><span class="line"></span><br><span class="line">tone_p+=<span class="number">3</span>; <span class="comment">//移动指针</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(*tone_p == <span class="number">8</span>) tone_p = song;   <span class="comment">//结束标志</span></span><br><span class="line"></span><br><span class="line">delay_ms(<span class="number">30</span>); <span class="comment">//延时一下，不延时特别难听</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>歌曲谱子数组：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> tones[]=    <span class="comment">//C调音调</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="number">3816</span>,<span class="number">3401</span>,<span class="number">3030</span>,<span class="number">2865</span>,<span class="number">2551</span>,<span class="number">2272</span>,<span class="number">2024</span>, <span class="comment">//低音</span></span><br><span class="line"><span class="number">1912</span>,<span class="number">1703</span>,<span class="number">1517</span>,<span class="number">1432</span>,<span class="number">1275</span>,<span class="number">1136</span>,<span class="number">1012</span>, <span class="comment">//中音</span></span><br><span class="line"><span class="number">965</span>, <span class="number">851</span>, <span class="number">758</span>, <span class="number">715</span>, <span class="number">605</span>, <span class="number">538</span>, <span class="number">466</span> <span class="comment">//高音</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code sky[]=&#123; <span class="comment">//谱子，天空之城</span></span><br><span class="line"><span class="comment">//格式： 音调， 音度， 拍数</span></span><br><span class="line"><span class="comment">//例： 4，1，1 //音调fa，中音，时长半拍</span></span><br><span class="line"><span class="comment">//0代表空音</span></span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,</span><br><span class="line"><span class="number">6</span>,<span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line"><span class="number">7</span>,<span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,</span><br><span class="line"><span class="number">7</span>,<span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line"><span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,</span><br><span class="line"><span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,</span><br><span class="line"><span class="number">8</span><span class="comment">//结束标志</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">sbit Buzzer=P1^<span class="number">5</span>; <span class="comment">//定义buzzer引脚</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> music_s=<span class="number">0</span>, t_tone=<span class="number">0</span>;     <span class="comment">//music_s用作定时器计时， t_tone保存音调时长</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span>  tone=<span class="number">0</span>;     <span class="comment">//tone保存音调，</span></span><br><span class="line"><span class="type">char</span> *tone_p=sky; <span class="comment">//指针指向要播放的曲目</span></span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 51单片机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>build-blog</title>
      <link href="/2020/08/18/build-blog/"/>
      <url>/2020/08/18/build-blog/</url>
      
        <content type="html"><![CDATA[<h1 id="如何使用gitee-hexo在gitee上部署blog"><a href="#如何使用gitee-hexo在gitee上部署blog" class="headerlink" title="如何使用gitee+hexo在gitee上部署blog"></a>如何使用gitee+hexo在gitee上部署blog</h1><h2 id="我搭建的blog网站：kiloGrand"><a href="#我搭建的blog网站：kiloGrand" class="headerlink" title="我搭建的blog网站：kiloGrand"></a>我搭建的blog网站：<a href="https://kilogrand.gitee.io/">kiloGrand</a></h2><h2 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h2><ul><li>下载git，推荐下载地址：<a href="https://pc.qq.com/detail/13/detail_22693.html">链接</a> ，在腾讯软件中心下载比较快</li><li>下载nodejs <a href="http://nodejs.cn/download/">官方下载</a>，我使用的版本是12.16.2，版本太高可能会出问题，推荐使用12.x.x系列的版本</li></ul><h2 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h2><ul><li>git 除了安装路径可以改之外，其他的不用改，一直next就行</li><li>nodejs 同上  </li></ul><h2 id="注册Gitee和GitHub账号"><a href="#注册Gitee和GitHub账号" class="headerlink" title="注册Gitee和GitHub账号"></a>注册Gitee和GitHub账号</h2><p><a href="https://github.com/">github官网</a><br><a href="https://gitee.com/">gitee官网</a><br>注意：在gitee和github中的设置-多邮件管理中,  “ [  ] 不公关我的邮箱地址”，这里不打勾，同时也要把你的邮箱设为提交邮箱<br><img src="https://img-blog.csdnimg.cn/20200821220646123.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUwMjU4ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><ul><li>下载hexo主题sakura <a href="https://github.com/honjun/hexo-theme-sakura">github的Sakura链接</a>  ，推荐下载链接：<a href="https://gitee.com/wczzsmmn/hexo-theme-sakura">gitee的Sakura下载链接</a></li><li><p>下载cdn文件 <a href="https://github.com/honjun/cdn">cdn文件github下载链接</a> ，推荐下载链接：<a href="https://gitee.com/kiloGrand/cdn">cdn文件下载gitee链接</a>  </p><p>gitee上下载文件的方法：点击右上角克隆/下载—-下载zip<br><img src="https://img-blog.csdnimg.cn/202008212219345.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUwMjU4ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p></li></ul><h2 id="初始化项目"><a href="#初始化项目" class="headerlink" title="初始化项目"></a>初始化项目</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">*</span> <span class="string">配置git</span>  </span><br><span class="line">  <span class="string">打开git</span>    </span><br><span class="line">    <span class="string">$</span> <span class="string">git</span> <span class="string">config</span> <span class="string">--global</span> <span class="string">user.name</span> <span class="string">&#x27;gitee用户名&#x27;</span>  </span><br><span class="line">    <span class="string">$</span> <span class="string">git</span> <span class="string">config</span> <span class="string">--global</span> <span class="string">user.email</span> <span class="string">&#x27;gitee登陆邮箱&#x27;</span></span><br><span class="line"><span class="string">*</span> <span class="string">安装hexo</span>  </span><br><span class="line">    <span class="string">$</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-cli</span> <span class="string">-g</span>  </span><br><span class="line"><span class="string">*</span> <span class="string">安装hexo-deployer-git</span>  </span><br><span class="line">    <span class="string">$</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-deployer-git</span> <span class="string">--save</span></span><br><span class="line"><span class="string">*</span> <span class="string">初始化项目</span>  </span><br><span class="line">    <span class="string">$</span> <span class="string">cd</span> <span class="string">E://blog_project</span>  </span><br><span class="line">    <span class="string">$</span> <span class="string">hexo</span> <span class="string">init</span> <span class="string">blog</span>  </span><br><span class="line">    <span class="string">$</span> <span class="string">cd</span> <span class="string">E://blog_project/blog</span>  </span><br><span class="line">    <span class="string">$</span> <span class="string">hexo</span> <span class="string">g</span> <span class="string">//依据网页文件和新的css样式生成新的网站文件</span>  </span><br><span class="line">    <span class="string">$</span> <span class="string">hexo</span> <span class="string">s</span> <span class="string">//启动本地服务器，可以在&lt;http://localhost:4000&gt;查看网站效果</span>  </span><br></pre></td></tr></table></figure><h2 id="使用jsDeliver-github搭建免费的cdn"><a href="#使用jsDeliver-github搭建免费的cdn" class="headerlink" title="使用jsDeliver+github搭建免费的cdn"></a>使用jsDeliver+github搭建免费的cdn</h2><p>参考教程见 <a href="https://www.jianshu.com/p/467290ea7e9f">简书链接</a>  </p><ol><li>在github上新建一个名为cdn的仓库 </li><li><p>把下载好的cdn文件解压到E://cdn中，里面的图片可以替换，文件名最后不要改变，建议在cdn目录下加一个大小在20m以内的短视频，后面会用到，下面是修改后并且上传到github后的样子：<br><img src="https://img-blog.csdnimg.cn/2020082122362875.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUwMjU4ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p></li><li><p>打开git<br> cd E://blog_project/cdn   </p></li><li><p>提交到github仓库上</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">git</span> <span class="string">init</span><span class="string">//初始化</span></span><br><span class="line"><span class="string">git</span> <span class="string">status</span> <span class="string">//查看状态</span>  </span><br><span class="line"><span class="string">git</span> <span class="string">add</span> <span class="string">.</span>  <span class="string">//添加文件到暂存区</span>  </span><br><span class="line"><span class="string">git</span> <span class="string">commit</span> <span class="string">-m</span> <span class="string">&#x27;第一次提交&#x27;</span> <span class="string">//</span> <span class="string">提交到本地库</span> </span><br><span class="line"><span class="string">​git</span> <span class="string">remote</span> <span class="string">add</span> <span class="string">github</span> <span class="string">cdn仓库链接</span> <span class="string">//关联远程仓库</span>  </span><br><span class="line"><span class="string">​git</span> <span class="string">pull</span> <span class="string">--rebase</span> <span class="string">github</span> <span class="string">master</span> <span class="string">//合并远程仓库和本地仓库的冲突</span>  </span><br><span class="line"><span class="string">git</span> <span class="string">push</span> <span class="string">github</span> <span class="string">master</span> <span class="string">//推送到远程仓库上</span>  </span><br><span class="line"><span class="string">(jsDeliver不支持加载超过20M的资源，所以一些视频最好压缩到20M以下)</span></span><br></pre></td></tr></table></figure></li><li><p>发布仓库：浏览器打开github中新建的cdn，点击release发布, 发布版本号1.0（自定义）<br>使用方法：<br><a href="https://cdn.jsdelivr.net/gh/user/repo@version/file">https://cdn.jsdelivr.net/gh/user/repo@version/file</a><br><a href="https://cdn.jsdelivr.net/gh/user/repo/file">https://cdn.jsdelivr.net/gh/user/repo/file</a><br>eg：  <a href="https://cdn.jsdelivr.net/gh/kiloGrand/cdn@1.2/img/custom/avatar.jpg">https://cdn.jsdelivr.net/gh/kiloGrand/cdn@1.2/img/custom/avatar.jpg</a>    <a href="https://cdn.jsdelivr.net/gh/kiloGrand/cdn/img/custom/avatar.jpg">https://cdn.jsdelivr.net/gh/kiloGrand/cdn/img/custom/avatar.jpg</a><br>版本号不是必需的，是为了区分新旧资源，如果不使用版本号，将会直接引用最新资源</p></li></ol><h2 id="blog配置"><a href="#blog配置" class="headerlink" title="blog配置"></a>blog配置</h2><ol><li>首先，在gitee上新建一个仓库，仓库名为你的账户名</li><li><p>用编辑器打开blog文件夹，我用的是vscode：<img src="https://img-blog.csdnimg.cn/20200821231313130.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUwMjU4ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p></li><li><p>把blog/source中的所有md文件、blog/themes/Sakura/languages/zh-cn.yml和blog/themes/Sakura/_config.yml中的 ‘<a href="https://cdn.jsdelivr.net/gh/">https://cdn.jsdelivr.net/gh/</a>…’ 改成自己的cdn的文件链接。</p></li><li>按照<a href="https://docs.hojun.cn/sakura/docs/#/home">官方文档</a>进行配置，每当配置完一部份，可以使用下面的命令来生成网页，访问<a href="http://localhost:4000">http://localhost:4000</a>查看网站效果<br> $ hexo clean<br> $ hexo g<br> $ hexo s  </li><li>配置scaffolds文件夹下的md文件，这个文件夹是关于博客文章的。</li></ol><p>注意：在配置首页媒体时，aplayer的ID是网易云音乐的歌单号，比如<a href="https://music.163.com/#/playlist?id=4958788236">https://music.163.com/#/playlist?id=4958788236</a> ，它的ID是 4958788236，只需把原来的ID替换成你想要的歌单的ID就行了，其实这个项目的所有的音乐部分的ID都是网易云歌单号的ID，你可以用自己的网易云账户创建一个歌单，供blog使用。</p><h2 id="blog部署"><a href="#blog部署" class="headerlink" title="blog部署"></a>blog部署</h2><ol><li>生成部署文件<br> $ hexo clean<br> $ hexo g<br> $ hexo d    //上传到远程在码云上的仓库  </li><li>登录码云账户，打开和自己用户名相同的仓库, 点击服务，打开giteePages，点击开启。</li></ol><p><img src="https://img-blog.csdnimg.cn/20200821225438232.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUwMjU4ODAw,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><h4 id="深入开发"><a href="#深入开发" class="headerlink" title="深入开发"></a>深入开发</h4><ul><li><a href="https://blog.csdn.net/u011759205/article/details/104839472">xx博客</a></li><li><a href="https://hexo.io/zh-cn/docs/index.html">hexo文档</a>  </li></ul><h2 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h2><ul><li>无法push到gitee/GitHub，可能是邮箱没有设置好，或者是_config.yml中的repo配置错了</li><li>hexo -g生成的public中的index是空的，可能是nodejs的版本太高，建议安装nvm来切换nodejs的版本  </li></ul><h2 id="博客使用"><a href="#博客使用" class="headerlink" title="博客使用"></a>博客使用</h2><p>编写文章的两种方法：  </p><ul><li>在git下执行<br>$ hexo new 博客文章名<br>同时会在 根目录下 /source/_posts 目录下生成md文件  </li><li>手动到根目录下 /source/_posts 目录下，创建一个makedown 文件进行编写就可以了</li></ul>]]></content>
      
      
      <categories>
          
          <category> 其他 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
